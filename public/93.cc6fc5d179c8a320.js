"use strict";(self.webpackChunkcliente_srff=self.webpackChunkcliente_srff||[]).push([[93],{5093:(E,f,i)=>{i.r(f),i.d(f,{DepositosClienteModule:()=>I});var g=i(9808),h=i(9648),e=i(4182),o=i(5e3),b=i(5554),Z=i(4586),C=i(2290),U=i(4153),A=i(8338),q=i(2704);const T=["fileUploader"],y=[{path:"",component:(()=>{class t{constructor(r,s,n,u,d,m,p){this.fb=r,this.afdb=s,this.afs=n,this.toastr=u,this.spinner=d,this.auth=m,this.depositoService=p,this.depositoService.depositos.subscribe(a=>this.depositos=a),this.auth.usuario.subscribe(a=>this.usuario=a),this.form=this.fb.group({valor:new e.NI(null,[e.kI.required,e.kI.min(20)]),banco:new e.NI(null,[e.kI.required]),comprobante:new e.NI(null,[e.kI.required,e.kI.minLength(8),e.kI.maxLength(15),e.kI.pattern("^[0-9]*$")])})}ngOnInit(){}registrar(){var r,s,n,u,d,m,p;if(!this.form.controls.valor.valid)return(null===(r=this.form.controls.valor.errors)||void 0===r?void 0:r.required)&&this.toastr.error("Ingrese el valor del deposito"),void((null===(s=this.form.controls.valor.errors)||void 0===s?void 0:s.min)&&this.toastr.error("El valor minimo del deposito es de $20"));if(null===(n=this.form.controls.banco.errors)||void 0===n?void 0:n.required)return void this.toastr.error("Seleccione el banco");if(!this.form.controls.comprobante.valid)return(null===(u=this.form.controls.comprobante.errors)||void 0===u?void 0:u.required)&&this.toastr.error("Ingrese el n\xfamero de comprobante"),(null===(d=this.form.controls.comprobante.errors)||void 0===d?void 0:d.minlength)&&this.toastr.error("El comprobante debe tener al menos 8 n\xfameros"),(null===(m=this.form.controls.comprobante.errors)||void 0===m?void 0:m.maxlength)&&this.toastr.error("El comprobante no debe tener mas de 15 n\xfameros"),void((null===(p=this.form.controls.comprobante.errors)||void 0===p?void 0:p.pattern)&&this.toastr.error("Comprobante no valido"));if(this.depositos.find(c=>c.comprobante===this.form.value.comprobante))return void this.toastr.error("N\xfamero de comprobante ya se encuentra registrado");let a=this.fileUploader.nativeElement.files[0];if(!a)return void this.toastr.error("Debe de subir la imagen del comprobante");if("image/jpeg"!=a.type&&"image/png"!=a.type)return void this.toastr.error("Solo se acepta imagenes");let N={comprobante:this.form.value.comprobante};this.spinner.show(),this.depositoService.comprobante(N).subscribe(c=>{if(c)return this.toastr.error("N\xfamero de comprobante ya se encuentra registrado"),void this.spinner.hide();let v="depositos/"+this.usuario.id_usuario+"/"+a.name;this.afs.upload(v,a).then(()=>{this.form.valid&&(this.form.value.id_usuario=this.usuario.id_usuario,this.form.value.usuario=this.usuario.nombre,this.form.value.date=(new Date).toLocaleString(),this.form.value.image_path=v,this.afdb.list("depositos").push(this.form.value).then(()=>{this.form.reset(),this.fileUploader.nativeElement.value=null,this.toastr.success("Deposito registrado"),this.spinner.hide()}))})},()=>this.spinner.hide())}}return t.\u0275fac=function(r){return new(r||t)(o.Y36(e.qu),o.Y36(b.KQ),o.Y36(Z.Q1),o.Y36(C._W),o.Y36(U.t2),o.Y36(A.e),o.Y36(q.M))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-depositos-cliente"]],viewQuery:function(r,s){if(1&r&&o.Gf(T,5),2&r){let n;o.iGM(n=o.CRH())&&(s.fileUploader=n.first)}},decls:48,vars:1,consts:[[1,"row"],[1,"col-md-6"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"card-description"],[3,"formGroup","submit"],[1,"form-group"],["type","number","step","0.01","min","20","max","9999","formControlName","valor","required","",1,"form-control"],["formControlName","banco","required","",1,"form-control",2,"background-color","#1a2035"],["value","Coopertativa JEP"],["value","Banco Pichincha"],["value","Banco Guayaquil"],["value","Produbanco"],["type","text","formControlName","comprobante","required","",1,"form-control"],["type","file",1,"mt-1"],["fileUploader",""],[1,"form-group","text-center"],["type","submit",1,"btn","btn-round","btn-primary"],["src","../../assets/img/letreros/deposito.jpeg","width","100%"]],template:function(r,s){1&r&&(o.TgZ(0,"div",0),o.TgZ(1,"div",1),o.TgZ(2,"div",2),o.TgZ(3,"div",3),o.TgZ(4,"h4",4),o._uU(5,"!Aviso!"),o.qZA(),o.TgZ(6,"p",5),o._uU(7," El Valor minimo de deposito debe de ser de $20."),o._UZ(8,"br"),o._uU(9," El deposito se validara de 5 a 30 minutos. "),o.qZA(),o._UZ(10,"br"),o.TgZ(11,"form",6),o.NdJ("submit",function(){return s.registrar()}),o.TgZ(12,"div",7),o.TgZ(13,"label"),o._uU(14,"Valor del deposito"),o.qZA(),o._UZ(15,"input",8),o.qZA(),o._UZ(16,"br"),o.TgZ(17,"div",7),o.TgZ(18,"label"),o._uU(19,"Banco / Cooperativa"),o.qZA(),o.TgZ(20,"select",9),o.TgZ(21,"option",10),o._uU(22,"Coopertativa JEP"),o.qZA(),o.TgZ(23,"option",11),o._uU(24,"Banco Pichincha"),o.qZA(),o.TgZ(25,"option",12),o._uU(26,"Banco Guayaquil"),o.qZA(),o.TgZ(27,"option",13),o._uU(28,"Produbanco"),o.qZA(),o.qZA(),o.qZA(),o._UZ(29,"br"),o.TgZ(30,"div",7),o.TgZ(31,"label"),o._uU(32,"N\xfamero del comprobante"),o.qZA(),o._UZ(33,"input",14),o.qZA(),o._UZ(34,"br"),o.TgZ(35,"div"),o._uU(36," Imagen del comprobante"),o._UZ(37,"br"),o._UZ(38,"input",15,16),o.qZA(),o._UZ(40,"br"),o.TgZ(41,"div",17),o.TgZ(42,"button",18),o._uU(43,"Registrar"),o.qZA(),o.qZA(),o._UZ(44,"br"),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(45,"div",1),o.TgZ(46,"div",2),o._UZ(47,"img",19),o.qZA(),o.qZA(),o.qZA()),2&r&&(o.xp6(11),o.Q6J("formGroup",s.form))},directives:[e._Y,e.JL,e.sg,e.qQ,e.Fd,e.wV,e.Fj,e.JJ,e.u,e.Q7,e.EJ,e.YN,e.Kr],styles:[""]}),t})()}];let D=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[h.Bz.forChild(y)],h.Bz]}),t})(),I=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[[g.ez,D,e.u5,e.UX]]}),t})()}}]);