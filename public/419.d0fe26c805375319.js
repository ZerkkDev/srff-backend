"use strict";(self.webpackChunkcliente_srff=self.webpackChunkcliente_srff||[]).push([[419],{4419:(E,d,s)=>{s.r(d),s.d(d,{HistorialRecargasModule:()=>z});var u=s(9808),g=s(9648),r=s(4182),_=s(1954),t=s(5e3),h=s(5554),f=s(2290),Z=s(4153),m=s(8338),v=s(7870),T=s(5875);function x(e,o){if(1&e&&t._UZ(0,"input",19),2&e){const i=t.oxw();t.Q6J("formControl",i.desde)}}function q(e,o){if(1&e&&t._UZ(0,"input",20),2&e){const i=t.oxw();t.Q6J("formControl",i.desde)}}function b(e,o){if(1&e&&t._UZ(0,"input",19),2&e){const i=t.oxw();t.Q6J("formControl",i.hasta)}}function A(e,o){if(1&e&&t._UZ(0,"input",20),2&e){const i=t.oxw();t.Q6J("formControl",i.hasta)}}function C(e,o){if(1&e&&(t.TgZ(0,"option",22),t._uU(1),t.qZA()),2&e){const i=o.$implicit;t.Q6J("value",i.id_precio),t.xp6(1),t.AsE(" $",i.prepago," | ",i.diamantes," ")}}function U(e,o){if(1&e&&(t.TgZ(0,"div",3),t.TgZ(1,"div",4),t.TgZ(2,"label"),t._uU(3,"Filtrar por precio"),t.qZA(),t.TgZ(4,"select",21),t.TgZ(5,"option",22),t._uU(6,"Todos"),t.qZA(),t.YNc(7,C,2,3,"option",23),t.qZA(),t.qZA(),t.qZA()),2&e){const i=t.oxw();t.xp6(4),t.Q6J("formControl",i.id_precio),t.xp6(1),t.Q6J("value",0),t.xp6(2),t.Q6J("ngForOf",i.precios)}}function H(e,o){1&e&&(t.TgZ(0,"th"),t._uU(1,"Usuario"),t.qZA())}function R(e,o){1&e&&(t.TgZ(0,"th"),t._uU(1,"Aprobado por"),t.qZA())}function J(e,o){if(1&e&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&e){const i=t.oxw().$implicit;t.xp6(1),t.Oqu(i.usuario)}}function I(e,o){if(1&e){const i=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"span",26),t._uU(2," Pendiente "),t.qZA(),t._uU(3,"\xa0 "),t.TgZ(4,"a",27),t.NdJ("click",function(){t.CHM(i);const n=t.oxw().$implicit;return t.oxw(2).reenviar(n)}),t.TgZ(5,"u"),t._uU(6,"Volver a recargar"),t.qZA(),t.qZA(),t._UZ(7,"br"),t._uU(8," Nota: Esta acci\xf3n no debitar\xe1 su saldo "),t.qZA()}}function w(e,o){if(1&e&&(t.TgZ(0,"div"),t.TgZ(1,"span",28),t._uU(2," Realizado "),t.qZA(),t._UZ(3,"br"),t._uU(4," Referencia"),t._UZ(5,"br"),t._uU(6),t.qZA()),2&e){const i=t.oxw().$implicit;t.xp6(6),t.hij(" ",i.descripcion," ")}}function y(e,o){if(1&e&&(t.TgZ(0,"div"),t.TgZ(1,"span",29),t._uU(2," Rechazado "),t.qZA(),t._UZ(3,"br"),t._uU(4),t.qZA()),2&e){const i=t.oxw().$implicit;t.xp6(4),t.hij(" ",i.descripcion," ")}}function N(e,o){if(1&e&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&e){const i=t.oxw().$implicit;t.xp6(1),t.Oqu(i.aprobado)}}function Q(e,o){if(1&e&&(t.TgZ(0,"tr"),t.YNc(1,J,2,1,"td",17),t.TgZ(2,"td"),t._uU(3),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA(),t.TgZ(8,"td"),t.YNc(9,I,9,0,"div",17),t.YNc(10,w,7,1,"div",17),t.YNc(11,y,5,1,"div",17),t.qZA(),t.YNc(12,N,2,1,"td",17),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"date"),t.qZA(),t.qZA()),2&e){const i=o.$implicit,a=t.oxw(2);t.xp6(1),t.Q6J("ngIf",1==(null==a.usuario?null:a.usuario.id_tipo)||4==(null==a.usuario?null:a.usuario.id_tipo)),t.xp6(2),t.Oqu(null!=a.usuario&&a.usuario.id_group?i.group_precio:i.precio),t.xp6(2),t.Oqu(i.id_jugador),t.xp6(2),t.Oqu(i.diamantes),t.xp6(2),t.Q6J("ngIf",2==i.realizado),t.xp6(1),t.Q6J("ngIf",1==i.realizado),t.xp6(1),t.Q6J("ngIf",0==i.realizado),t.xp6(1),t.Q6J("ngIf",1==(null==a.usuario?null:a.usuario.id_tipo)||4==(null==a.usuario?null:a.usuario.id_tipo)),t.xp6(2),t.Oqu(t.xi3(15,9,i.created_at,"d/M/y, h:mm a"))}}function Y(e,o){if(1&e&&(t.TgZ(0,"table",24),t.TgZ(1,"thead"),t.YNc(2,H,2,0,"th",17),t.TgZ(3,"th"),t._uU(4,"Precio"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"Id jugador"),t.qZA(),t.TgZ(7,"th"),t._uU(8,"Diamantes"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Estado"),t.qZA(),t.YNc(11,R,2,0,"th",17),t.TgZ(12,"th"),t._uU(13,"Fecha"),t.qZA(),t.qZA(),t.TgZ(14,"tbody"),t.YNc(15,Q,16,12,"tr",25),t.qZA(),t.qZA()),2&e){const i=t.oxw();t.xp6(2),t.Q6J("ngIf",1==(null==i.usuario?null:i.usuario.id_tipo)||4==(null==i.usuario?null:i.usuario.id_tipo)),t.xp6(9),t.Q6J("ngIf",1==(null==i.usuario?null:i.usuario.id_tipo)||4==(null==i.usuario?null:i.usuario.id_tipo)),t.xp6(4),t.Q6J("ngForOf",null==i.page?null:i.page.data)}}function j(e,o){if(1&e&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&e){const i=t.oxw().$implicit;t.xp6(1),t.Oqu(i.label)}}function k(e,o){if(1&e&&t._UZ(0,"i"),2&e){const i=t.oxw().$implicit;t.Tol(i.icon)}}function F(e,o){if(1&e){const i=t.EpF();t.TgZ(0,"li"),t.TgZ(1,"button",32),t.NdJ("click",function(){const l=t.CHM(i).$implicit;return t.oxw(2).paginate(l.url)}),t.YNc(2,j,2,1,"div",17),t.YNc(3,k,1,2,"i",36),t.qZA(),t.qZA()}if(2&e){const i=o.$implicit;t.MT6("page-item ",i.active?"active":""," ",i.url?"":"disabled",""),t.xp6(2),t.Q6J("ngIf",!i.icon),t.xp6(1),t.Q6J("ngIf",i.icon)}}function M(e,o){if(1&e){const i=t.EpF();t.TgZ(0,"nav"),t.TgZ(1,"ul",30),t.TgZ(2,"li",31),t.TgZ(3,"button",32),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return n.paginate(null==n.page?null:n.page.first_page_url)}),t._UZ(4,"i",33),t.qZA(),t.qZA(),t.YNc(5,F,4,6,"li",34),t.TgZ(6,"li",31),t.TgZ(7,"button",32),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return n.paginate(null==n.page?null:n.page.last_page_url)}),t._UZ(8,"i",35),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&e){const i=t.oxw();t.xp6(5),t.Q6J("ngForOf",null==i.page?null:i.page.links)}}function D(e,o){if(1&e){const i=t.EpF();t.TgZ(0,"div",37),t.TgZ(1,"div",3),t._UZ(2,"input",38),t.qZA(),t.TgZ(3,"div",3),t.TgZ(4,"button",8),t.NdJ("click",function(){return t.CHM(i),t.oxw().calcularGanancia()}),t._uU(5," Calcular "),t.qZA(),t.qZA(),t.TgZ(6,"div",3),t.TgZ(7,"label"),t._uU(8),t.qZA(),t.qZA(),t.qZA()}if(2&e){const i=t.oxw();t.xp6(2),t.Q6J("formControl",i.porcentaje),t.xp6(6),t.Oqu(i.ganancia)}}const O=[{path:"",component:(()=>{class e{constructor(i,a,n,l,c,$,B){this.afdb=i,this.datePipe=a,this.toastr=n,this.spinner=l,this.auth=c,this.recargaService=$,this.precioService=B,this.auth.usuario.subscribe(p=>{this.usuario=p}),this.precioService.precios.subscribe(p=>this.precios=p),this.desde=new r.NI(null,r.kI.required),this.hasta=new r.NI(null,r.kI.required),this.id_jugador=new r.NI(null,r.kI.required),this.porcentaje=new r.NI(null,r.kI.required),this.id_precio=new r.NI(0,r.kI.required)}ngOnInit(){}validateDates(){if(!this.desde.valid||!this.hasta.valid)return void this.toastr.error("Seleccione dos fechas");let i=new Date(this.desde.value),a=new Date(this.hasta.value);if(!(i>a))return i=(0,_.Z)(i,1),a=(0,_.Z)(a,2),{desde:this.datePipe.transform(i,"yyyy-MM-dd"),hasta:this.datePipe.transform(a,"yyyy-MM-dd"),porcentaje:this.porcentaje.value};this.toastr.error("Fechas no validas")}validateDates2(){if(this.desde.valid&&this.hasta.valid)return new Date(this.desde.value)>new Date(this.hasta.value)?void this.toastr.error("Fechas no validas"):{desde:this.desde.value,hasta:this.hasta.value,porcentaje:this.porcentaje.value,id_precio:this.id_precio.value};this.toastr.error("Seleccione dos fechas")}showByDates(){var i;this.id_jugador.reset(),this.request=1==(null===(i=this.usuario)||void 0===i?void 0:i.id_tipo)?this.validateDates2():this.validateDates(),this.request&&(this.spinner.show(),this.recargaService.showByDates(this.request).subscribe(a=>{this.setPage(a),this.spinner.hide()},()=>this.spinner.hide()))}showByIdJugador(){this.desde.reset(),this.hasta.reset(),this.id_precio.reset(),this.id_jugador.valid?(this.request={id_jugador:this.id_jugador.value},this.spinner.show(),this.recargaService.showByIdJugador(this.request).subscribe(i=>{this.setPage(i),this.spinner.hide()},()=>this.spinner.hide())):this.toastr.error("Ingrese el ID del jugador")}paginate(i){this.request&&(this.spinner.show(),this.recargaService.paginate(this.request,i).subscribe(a=>{this.setPage(a),this.spinner.hide()},()=>this.spinner.hide()))}setPage(i){i&&(this.page=i,this.page.links[0].icon="fa fa-angle-left",this.page.links[this.page.links.length-1].icon="fa fa-angle-right")}calcularGanancia(){let i=0;this.porcentaje.valid&&(this.request=this.validateDates2(),this.spinner.show(),this.recargaService.calcularGanancia(this.request).subscribe(a=>{a.forEach(n=>{let l=this.porcentaje.value*Math.ceil(n);i+=n-l}),this.ganancia=+i.toFixed(2),this.spinner.hide()},()=>this.spinner.hide()))}reenviar(i){this.spinner.show(),this.recargaService.show(i.id).subscribe(a=>{2==a.realizado?this.recargaService.recargas.value.find(c=>c.id==a.id)?this.toastr.warning("La recarga ya esta en cola."):this.afdb.list("recargas").push(a).then(()=>this.toastr.success("Recarga enviada")):this.page.data=this.page.data.map(n=>n.id==a.id?a:n),this.spinner.hide()},()=>this.spinner.hide())}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(h.KQ),t.Y36(u.uU),t.Y36(f._W),t.Y36(Z.t2),t.Y36(m.e),t.Y36(v.E),t.Y36(T.v))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-historial-recargas"]],decls:30,vars:9,consts:[[1,"card"],[1,"card-header"],[1,"row"],[1,"col-md-3"],[1,"form-group"],["type","date","class","form-control",3,"formControl",4,"ngIf"],["type","datetime-local","class","form-control",3,"formControl",4,"ngIf"],["class","col-md-3",4,"ngIf"],["type","button",1,"btn","btn-round","btn-primary",3,"click"],[1,"input-group",3,"submit"],["type","text","placeholder","ID de jugador",1,"form-control",3,"formControl"],[1,"input-group-prepend"],["type","submit",1,"btn","btn-just-icon","btn-sm","btn-primary"],[1,"fa","fa-search"],[1,"card-body"],[1,"table-responsive"],["class","table",4,"ngIf"],[4,"ngIf"],["class","row justify-content-center",4,"ngIf"],["type","date",1,"form-control",3,"formControl"],["type","datetime-local",1,"form-control",3,"formControl"],[1,"form-control",2,"background-color","#202940",3,"formControl"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"table"],[4,"ngFor","ngForOf"],[1,"badge","bg-warning","text-dark",2,"font-size","small"],["href","javascript:;",3,"click"],[1,"badge","bg-success","text-dark",2,"font-size","small"],[1,"badge","bg-danger","text-dark",2,"font-size","small"],[1,"pagination"],[1,"page-item"],[1,"page-link",3,"click"],[1,"fa","fa-angle-double-left"],[3,"class",4,"ngFor","ngForOf"],[1,"fa","fa-angle-double-right"],[3,"class",4,"ngIf"],[1,"row","justify-content-center"],["type","number","min","0.8","max","1","step","0.01",1,"form-control",3,"formControl"]],template:function(i,a){1&i&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"div",4),t.TgZ(5,"label"),t._uU(6,"Desde"),t.qZA(),t.YNc(7,x,1,1,"input",5),t.YNc(8,q,1,1,"input",6),t.qZA(),t.qZA(),t.TgZ(9,"div",3),t.TgZ(10,"div",4),t.TgZ(11,"label"),t._uU(12,"Hasta"),t.qZA(),t.YNc(13,b,1,1,"input",5),t.YNc(14,A,1,1,"input",6),t.qZA(),t.qZA(),t.YNc(15,U,8,3,"div",7),t.TgZ(16,"div",3),t.TgZ(17,"button",8),t.NdJ("click",function(){return a.showByDates()}),t._uU(18," Buscar "),t.qZA(),t.qZA(),t.TgZ(19,"div",3),t.TgZ(20,"form",9),t.NdJ("submit",function(){return a.showByIdJugador()}),t._UZ(21,"input",10),t.TgZ(22,"div",11),t.TgZ(23,"button",12),t._UZ(24,"i",13),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(25,"div",14),t.TgZ(26,"div",15),t.YNc(27,Y,16,3,"table",16),t.YNc(28,M,9,1,"nav",17),t.qZA(),t.qZA(),t.YNc(29,D,9,2,"div",18),t.qZA()),2&i&&(t.xp6(7),t.Q6J("ngIf",1!=(null==a.usuario?null:a.usuario.id_tipo)),t.xp6(1),t.Q6J("ngIf",1==(null==a.usuario?null:a.usuario.id_tipo)),t.xp6(5),t.Q6J("ngIf",1!=(null==a.usuario?null:a.usuario.id_tipo)),t.xp6(1),t.Q6J("ngIf",1==(null==a.usuario?null:a.usuario.id_tipo)),t.xp6(1),t.Q6J("ngIf",1==(null==a.usuario?null:a.usuario.id_tipo)),t.xp6(6),t.Q6J("formControl",a.id_jugador),t.xp6(6),t.Q6J("ngIf",a.page),t.xp6(1),t.Q6J("ngIf",null==a.page?null:a.page.links),t.xp6(1),t.Q6J("ngIf",a.page&&1==(null==a.usuario?null:a.usuario.id_tipo)))},directives:[u.O5,r.Fj,r.JJ,r.oH,r.EJ,r.YN,r.Kr,u.sg,r._Y,r.JL,r.F,r.qQ,r.Fd,r.wV],pipes:[u.uU],styles:[""]}),e})()}];let S=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[g.Bz.forChild(O)],g.Bz]}),e})(),z=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[u.uU],imports:[[u.ez,S,r.u5,r.UX]]}),e})()}}]);